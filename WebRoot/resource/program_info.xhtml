<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">

<link rel="stylesheet" href="../css/admin/program_info.css" type="text/css"></link>
	

<div class="toolbar" id="equipment_type_center_right_top">
	<h:inputText id="txt" value="#{ProgramInfoBean.searchStr}" styleClass="input-toolbar" onfocus="searchFocus('myform:txt');" 
	onblur="searchBlur('myform:txt');" /> 		
	<h:commandLink value="查询" render=":myform:carList" styleClass="iconBtn-toolbar iconBtn-search" action="#{ProgramInfoBean.query}" />
	<div class="split-toolbar"></div>	
	<p:commandLink value="新建" update=":myform:addTpr" styleClass="iconBtn-toolbar iconBtn-search" onclick="addProgram.show()" />
	<div class="split-toolbar"></div>
	<p:commandLink value="删除" update=":myform:set" styleClass="iconBtn-toolbar iconBtn-search" oncomplete="ondelete();" 
		actionListener="#{ProgramInfoBean.onSelected}" />
	<p:commandButton id="delete" value="删除" update=":myform:carList :myform:displayMulti"  actionListener="#{ProgramInfoBean.deleteTprogramInfo}"  style="display: none;"/>
	<div class="split-toolbar"></div> 
</div>
<div class="table-p-bg"></div>
<p:dataTable var="tpro" value="#{ProgramInfoBean.mediumTprogramModel}" id="carList" editable="true" 
   	  sortMode="multiple" dynamic="true" selection="#{ProgramInfoBean.selectedProgram}" paginator="true" rows="22" 
   	  paginatorPosition="bottom" styleClass="table-p">
   	  
   	<p:ajax event="rowEdit" listener="#{ProgramInfoBean.updateTprogramInfo}" update=":myform:carList :myform:messages" />
       <p:ajax event="rowEditCancel" listener="#{ProgramInfoBean.onCancel}" update=":myform:carList" />
   	  
   	<p:column selectionMode="multiple" />
   	<p:column headerText="流水号" >
           <p:cellEditor >
               <f:facet name="output" >
                   <h:outputText value="#{tpro.id}" />
               </f:facet>
               <f:facet name="input" >
                   <h:outputText value="#{tpro.id}" />
               </f:facet>
           </p:cellEditor>
       </p:column>
   	 <p:column headerText="程序编号" >
           <p:cellEditor >
               <f:facet name="output" >
                   <h:outputText value="#{tpro.progNo}" />
               </f:facet>
               <f:facet name="input" >
                   <p:inputText value="#{tpro.progNo}" styleClass="input"/>
               </f:facet>
           </p:cellEditor>
       </p:column>

       <p:column headerText="程序名称">
           <p:cellEditor>
               <f:facet name="output">
                   <h:outputText value="#{tpro.progName}" />
               </f:facet>
               <f:facet name="input">
               	<p:inputText value="#{tpro.progName}" styleClass="input"/>
               </f:facet>
           </p:cellEditor>
       </p:column>
       
       <p:column headerText="创建人">
           <p:cellEditor>
               <f:facet name="output">
                   <h:outputText value="#{tpro.creator}"/>
               </f:facet>
               <f:facet name="input">
               	<p:inputText value="#{tpro.creator}" styleClass="input"  readonly="true"/>
               </f:facet>
           </p:cellEditor>
       </p:column>
       
       <p:column headerText="创建时间">
           <p:cellEditor>
               <f:facet name="output">
                   <h:outputText value="#{tpro.createTime}" readonly="true">
                    <f:convertDateTime pattern="yyyy-MM-dd HH:mm:ss"></f:convertDateTime>
                   </h:outputText>
               </f:facet>
               <f:facet name="input">
               	<p:inputText value="#{tpro.createTime}" styleClass="input" readonly="true"/>
               </f:facet>
           </p:cellEditor>
       </p:column>
       
      <p:column headerText="更新人">
           <p:cellEditor>
               <f:facet name="output">
                   <h:outputText value="#{tpro.updator}"/>
               </f:facet>
               <f:facet name="input">
               	<p:inputText value="#{tpro.updator}" styleClass="input" readonly="true"/>
               </f:facet>
           </p:cellEditor>
       </p:column>
       
        <p:column headerText="更新时间">
           <p:cellEditor>
               <f:facet name="output">
                   <h:outputText value="#{tpro.updateTime}">
                    <f:convertDateTime pattern="yyyy-MM-dd HH:mm:ss"></f:convertDateTime>
                    </h:outputText>
               </f:facet>
               <f:facet name="input">
              	 	<p:inputText value="#{tpro.updateTime}" styleClass="input" readonly="true"/>
               </f:facet>
           </p:cellEditor>
       </p:column>
       
       <p:column headerText="程序内容">
           <p:cellEditor>
               <f:facet name="output">
                   <h:outputText value="#{tpro.content}"/>
               </f:facet>
               <f:facet name="input">
               	<p:inputText value="#{tpro.content}" styleClass="input" />
               </f:facet>
           </p:cellEditor>
       </p:column>

       <p:column headerText="操作">
           <p:rowEditor />
       </p:column>	
</p:dataTable>  
 
    <!-- 添加 -->
<p:dialog widgetVar="addProgram" resizable="false">
	<h:panelGroup id="addTpr">
		<table>
			<tr>
				<td>程序编号：<font style="color:red;">*</font></td>
				<td><h:inputText value="#{ProgramInfoBean.addTpro.progNo}" id="progNo" styleClass="input-toolbar"></h:inputText></td>
				<td><div style="color: gray;">例：BZLP-SETUP01</div></td>
			</tr>
			<tr>
				<td>程序名称：<font style="color:red;">*</font></td>
				<td><h:inputText value="#{ProgramInfoBean.addTpro.progName}" id="progName" styleClass="input-toolbar"></h:inputText></td>
				<td><div style="color: gray;">例：BZLP-SETUP01</div></td>
			</tr>
			<tr>
				<td>内容：</td>
				<td colspan="2">
					<h:inputText value="#{ProgramInfoBean.addTpro.content}" styleClass="input-toolbar" />
				</td>
			</tr>
		</table>
	 	<div class="headDivduan">
			<p:commandLink value="新增" onclick="onsubbtn()" styleClass="iconBtn-toolbar iconBtn-search" style="margin-left:1.8rem"/>
			<p:commandButton actionListener="#{ProgramInfoBean.addTprogramInfo}"  value="增加" id="addcxbtn"
				update=":myform:carList :myform:addTpr :myform:messages" oncomplete="addProgram.hide()" style="display:none;">
			</p:commandButton>	    				
			<p:growl id="messages" showDetail="true"/>	
	 	</div>
	</h:panelGroup>
</p:dialog>
    
<!-- 删除 -->
<p:dialog id="multiDialog" height="200" showEffect="fade" hideEffect="explode"  widgetVar="multiCarDialog">
    <p:dataList id="displayMulti" value="#{ProgramInfoBean.selectedProgram}" var="tpro"></p:dataList>  
</p:dialog>    
       
<h:inputHidden value="#{ProgramInfoBean.selected}" id="set"></h:inputHidden>

    <script type="text/javascript">
	 	//<![CDATA[
	 		document.getElementById("myform:txt").value="输入编号/名称";
	 	     //删除
		 	 function ondelete(){
		  	   var temp = document.getElementById("myform:set").value;
		  	   if(null!=temp&&""!=temp){
		  		   if(confirm("是否确认删除此数据！")){
			    	   document.getElementById("myform:delete").click();
			    	} 
		  	   }else{
		  		   alert("请选择一条数据进行删除！");
		  	   }
		     }
			 function onsubbtn(){
	    	   var progNo =document.getElementById("myform:progNo").value;
	    	   var progName =document.getElementById("myform:progName").value;
	    	   if(null==progNo||""==progNo){
	    		   alert("请输入程序编号！");
	    	   }else if(null==progName||""==progName){
	    		   alert("请输入程序名字！");
	    	   }else{
	    		   document.getElementById("myform:addcxbtn").click();   
	    	   }
			 }
		 	 function searchFocus(id){
	 				if(document.getElementById(id).value=="输入编号/名称/创建人")
	 					document.getElementById(id).value=""
	 			}
	 			
	 			function searchBlur(id){
	 				if(document.getElementById(id).value=="")
	 					document.getElementById(id).value="输入编号/名称/创建人"
	 			}
	    	   
		//]]>
   </script>   


</ui:composition>