<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">

<link rel="stylesheet" href="../css/b21.css" type="text/css"></link>	
<link rel="stylesheet" href="../css/b22.css" type="text/css"></link>

<div style="width: 100%;height: 100%; position: relative;">
 	<div class="headDiv" id="equipment_type_center_right_top">
		<div style="width: 100%;height: 5px;"></div>
	    <p:commandButton id="add" value="新建" update=":myform:apart" oncomplete="addPartTypelog.show();bgReposition($('.table'))"   styleClass="delete"/> 
	    <p:commandButton  value="删除" styleClass="delete"  actionListener="#{EquipmentType.onSelected}" oncomplete="ondelete();bgReposition($('.table'))" update=":myform:sed" /> 
	    <p:commandButton id="delete" value="删除" update=":myform:carList :myform:displayMulti :myform:tree"  actionListener="#{EquipmentType.onDelete}" style="display:none;"/> 
		<p:commandButton value="导出" oncomplete="onOutput()" styleClass="delete" />
		<h:commandButton id="output" value="导出" action="#{EquipmentType.downloadExcel}" style="display: none;"></h:commandButton>
	
	</div>
	<div class="div-content-top-shadow">
		<img src="../images/demo/right_top_shadow.png" />
	</div>
	<div class="materail_class_treeDiv">
		<div class="tree-head"></div>
		<div class="tree-body">
			<p:tree value="#{EquipmentType.root}" var="node" id="tree" selectionMode="single"  selection="#{EquipmentType.treeSelectedEqu}"  >  
					<p:ajax event="select" update=":myform:carList"
						listener="#{EquipmentType.onNodeSelect}" execute="@this" oncomplete="bgReposition($('.table'))" />
		        <p:treeNode id="treeNode">  
		            <h:outputText value="#{node.equipmentType}" id="lblNode"/>  
		        </p:treeNode>  
		    </p:tree>  
	    </div>
		<div class="tree-foot"></div>
		<div class="div_tree_border_shadow">
			<img src="../images/demo/tree_border_shadow.png" />
		</div>
		<div id="tree_move_btn" class="btn_tree_show"></div>
	</div>
	<div class="materail_class_rightDiv hidden">
	 	<p:dataTable id="carList" var="record" value="#{EquipmentType.mediumEquipmentTypeInfoModel}" paginator="true" rows="10" 
	 	paginatorPosition="bottom" editable="true"   styleClass="table" selection="#{EquipmentType.selectedEquipment}">  
        <p:ajax event="rowEdit" listener="#{EquipmentType.onEdit}" update=":myform:carList :myform:messages" />
        <p:ajax event="rowEditCancel" listener="#{EquipmentType.onCancel}" update=":myform:carList" />
  
        <p:column headerText="" style="width:5%;word-break: break-all;" />
        <p:column selectionMode="multiple"  style="width:5%;word-break: break-all;" />
        <p:column headerText="设备类型名称" style="width:15%;word-break: break-all;" >  
           <p:cellEditor>
                <f:facet name="output">
                    <h:outputText value="#{record.equipmentType}" />
                </f:facet>
                <f:facet name="input">
                    <p:inputText value="#{record.equipmentType}"   />
                </f:facet>
            </p:cellEditor>
        </p:column>       
  
        <p:column headerText="分类编码" style="width:15%;word-break: break-all;" >   
             
            <p:cellEditor>
                <f:facet name="output">
                    <h:outputText value="#{record.typecode}" />
                </f:facet>
                <f:facet name="input">
                    <p:inputText value="#{record.typecode}" />
                </f:facet>
            </p:cellEditor>
        </p:column> 
        
        <ui:remove>
        <p:column headerText="父设备类型" style="width:15%;word-break: break-all;" >   
             
            <p:cellEditor>
                <f:facet name="output">
                    <h:outputText value="#{record.parentName}" />
                </f:facet>
                <f:facet name="input">
                    <h:outputText value="#{record.parentName}"   />
                </f:facet>
            </p:cellEditor>
        </p:column>  
        </ui:remove>
  
        <p:column headerText="型号/牌号" style="width:15%;word-break: break-all;" >   
             
            <p:cellEditor>
                <f:facet name="output">
                    <h:outputText value="#{record.norm}" />
                </f:facet>
                <f:facet name="input">
                    <p:inputText value="#{record.norm}" />
                </f:facet>
            </p:cellEditor>
        </p:column>  
  
        <p:column headerText="数控系统" style="width:10%;word-break: break-all;" >  
             
            <p:cellEditor>
                <f:facet name="output">
                    <h:outputText value="#{record.cnc}" />
                </f:facet>
                <f:facet name="input">
                    <p:inputText value="#{record.cnc}"   />
                </f:facet>
            </p:cellEditor>
        </p:column>  
        <p:column headerText="能力组号" style="width:10%;word-break: break-all;" >  
            <p:cellEditor>
                <f:facet name="output">
                    <h:outputText value="#{record.erpResouceCode}" />
                </f:facet>
                <f:facet name="input">
                    <p:inputText value="#{record.erpResouceCode}"   />
                </f:facet>
            </p:cellEditor>
        </p:column> 
        <p:column headerText="能力描述" style="width:10%;word-break: break-all;" >  
             
            <p:cellEditor>
                <f:facet name="output">
                    <h:outputText value="#{record.erpResouceDesc}" />
                </f:facet>
                <f:facet name="input">
                    <p:inputText value="#{record.erpResouceDesc}"   />
                </f:facet>
            </p:cellEditor>
        </p:column> 
        
        <p:column headerText="类型描述" style="width:15%;word-break: break-all;" >  
             
             <p:cellEditor>
                <f:facet name="output">
                    <h:outputText value="#{record.description}" />
                </f:facet>
                <f:facet name="input">
                    <p:inputText value="#{record.description}"   />
                </f:facet>
            </p:cellEditor>  
        </p:column>        
        <p:column headerText="操作" style="width:5%;word-break: break-all;" >
            <p:rowEditor />
        </p:column>

    </p:dataTable> 	
		
		
 <p:dialog id="addlog" widgetVar="addPartTypelog" resizable="false">
      <h:panelGroup id="apart">
      	<table>
      		<tr>
      			<td><h:outputText value="设备类型名称：" /><h:outputText style="color:red;" value="*" /></td>
      			<td><h:inputText id="equipmentType" value="#{EquipmentType.equTypeObj.equipmentType}"  styleClass=""/></td>
      			<td><div style="color: gray;">例：ETC3650lu</div></td>
      		</tr>
      		<tr>
      			<td><h:outputText value="分类编码：" /><h:outputText style="color:red;" value="*" /></td>
      			<td><h:inputText id="typecode" value="#{EquipmentType.equTypeObj.typecode}"  styleClass=""/></td>
      			<td><div style="color: gray;">例：ETC3650lu</div></td>
      		</tr>
      		<tr>
      			<td><h:outputText value="型号/牌号：" /></td>
      			<td><h:inputText id="norm" value="#{EquipmentType.equTypeObj.norm}" styleClass="" /></td>
      			<td><div style="color: gray;">例：ETC3650lu</div></td>
      		</tr>
      		<tr>
      			<td><h:outputText value="能力组号：" /></td>
      			<td><h:inputText  value="#{EquipmentType.equTypeObj.erpResouceCode}" styleClass="" /></td>
      			<td><div style="color: gray;">例：ETC3650lu</div></td>
      		</tr>
      		<tr>
      			<td><h:outputText value="能力描述：" /></td>
      			<td><h:inputText  value="#{EquipmentType.equTypeObj.erpResouceDesc}" styleClass="" /></td>
      			<td><div style="color: gray;">例：ETC3650lu</div></td>
      		</tr>
      		<tr>
      			<td><h:outputText value="数控系统：" /></td>
      			<td><h:inputText id="cnc" value="#{EquipmentType.equTypeObj.cnc}"  styleClass=""/></td>
      			<td><div style="color: gray;">例：i5</div></td>
      		</tr>
      		<tr>
      			<td><h:outputText value="父设备类型："  /><h:outputText style="color:red;" value="*" /></td>
      			<td>
      				<h:selectOneMenu id="addequId"  
						value="#{EquipmentType.equTypeObj.TEquipmenttypeInfo.id}" styleClass="">
						<f:selectItem itemLabel="请选择" itemValue=""></f:selectItem>
						<f:selectItems value="#{EquipmentType.equTypeMap}"></f:selectItems>
					</h:selectOneMenu>	
      			</td>
      			<td></td>
      		</tr>
      		<tr>
      			<td><h:outputText value="类型描述：" /></td>
      			<td colspan="2">
      				<h:inputTextarea id="description" value="#{EquipmentType.equTypeObj.description}" cols="40"></h:inputTextarea>
      			</td>
      		</tr>
      	</table>
      	<div class="headDivduan">
			<p:commandButton onclick="onAdd()" value="增加" styleClass="delete"></p:commandButton>
			<p:commandButton actionListener="#{EquipmentType.addEquType}"  oncomplete="addPartTypelog.hide()" 
			 value="增加" update=":myform:carList :myform:apart :myform:messages :myform:dialogshow :myform:tree" style="display:none;" id="addPartType">
			</p:commandButton>
			<p:commandButton oncomplete="addPartTypelog.hide()"  value="取消" styleClass="delete"></p:commandButton>
      	</div>
    </h:panelGroup>
    </p:dialog>
    
    <p:dialog id="multiDialog"  widgetVar="multiCarDialog"  height="200" showEffect="fade" hideEffect="explode" >  
        <p:dataList id="displayMulti" value="#{EquipmentType.selectedEquipment}" var="process"> 
        </p:dataList>  
    </p:dialog>
		
		</div>
</div>	
<p:growl id="messages" showDetail="true"/> 
 <h:inputHidden value="#{EquipmentType.selected}" id="sed"></h:inputHidden>
       <script type="text/javascript">
	//<![CDATA[
	       function ondelete(){
	    	   var temp=document.getElementById("myform:sed").value;
	    	   if(null!=temp&&""!=temp){
	    		   if(temp == "nouse"){
	    		      if(confirm("是否确认删除此数据！")){
		    		     document.getElementById("myform:delete").click();
		    	      } 
	    		   }else{
	    			   alert("类型已使用，无法删除！");
	    		   }
	    	   }else{
	    		   alert("请选择一条数据进行删除！");
	    	   }
	       }
	       
	       function onClear(){
	    	   if(confirm("是否确认要清空数据,请慎重选择！")){
	    		   document.getElementById("myform:clear").click();
	    	   }
	       }
	       function onStop(){
	    	   var temp=document.getElementById("myform:sed").value;
	    	   if(null!=temp&&""!=temp){
	    		   if(confirm("是否确认停用这些数据！")){
		    		   document.getElementById("myform:disabled").click();
		    	   } 
	    	   }else{
	    		   alert("请选择一条数据进行停用！");
	    	   }
	       }
	       function onAdd(){	       
	    	   var addequId=document.getElementById("myform:addequId").value;
	    	   var equipmentType=document.getElementById("myform:equipmentType").value;
	    	   var typecode=document.getElementById("myform:typecode").value;
	    	   if(null==addequId||""==addequId){
	    		   alert("请选择父设备类型");
	    		   return false;
	    	   }	   	   
	    	   else  if(null==equipmentType||""==equipmentType){
	    		   alert("请输入设备类型名称");
	    		   return false;
	    	   }else if(null==typecode||""==typecode){
	    		   alert("请输入分类编码");
	    		   return false;
	    	   }	    	   
	    	   else{	    	   
	    		   document.getElementById("myform:addPartType").click();
	   	       }
	       }
	       function onOutput() {
	    	   //$("#myform:ouput").click();
    		   document.getElementById("myform:output").click();
	       }

	       
	//]]>
	</script>
	 <h:inputHidden value="#{EquipmentType.dialogtonul}" id="dialogtonul"></h:inputHidden>
	 <rich:panel id="dialogshow">
     <h:inputHidden value="#{EquipmentType.dialog}" id="dialog"></h:inputHidden>
     <script type="text/javascript">
	//<![CDATA[
	       document.getElementById("myform:equipmentType").value = null;
	       document.getElementById("myform:typecode").value = null;
	       document.getElementById("myform:norm").value = null;
	       document.getElementById("myform:cnc").value = null;
	       document.getElementById("myform:description").value = null;
	       
	      var temp=document.getElementById("myform:dialog").value;
	    	   if(null!=temp&&"show"==temp){
	              alert("类型已存在，不要重复添加!");
	    	   }
	      document.getElementById("myform:dialog").value =null;   //取值后清空 
	 //]]>
	</script>
   </rich:panel>	
	<h:outputScript library="js" name="table_tree.js"></h:outputScript>
</ui:composition>