<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:p="http://primefaces.org/ui">
	
	<link rel="stylesheet" href="../css/admin/member_setting.css" type="text/css"></link>
	
	<div class="toolbar">
	     <input type="hidden" id="txt_placeholder" data-i18n="[value]page1.top.input1" value=""></input>
	     
	     <h:inputText id="txt" styleClass="input-toolbar" onfocus="searchFocus('myform:txt');" onblur="searchBlur('myform:txt');" 
	     	value="#{MemberManagementBean.searchType}"/>
   		 <p:commandLink id="btn1" style="" value="page1.top.btn1"  styleClass="iconBtn-toolbar iconBtn-search" 
   		 	action="#{MemberManagementBean.searchList}" update=":myform:tb" oncomplete="transElementId('myform:tb')">
   		 </p:commandLink>
   		 
   		 <p:commandLink style="" value="page1.top.btn2"  styleClass="iconBtn-toolbar iconBtn-add" oncomplete="adddate.show()"></p:commandLink>
   		 <p:commandLink style="" value="page1.top.btn3"  styleClass="iconBtn-toolbar iconBtn-edit" update=":myform" oncomplete="update.show()"></p:commandLink>
   		 <p:commandLink style="" value="page1.top.btn4"  styleClass="iconBtn-toolbar iconBtn-del"  onclick="return del();" action="#{MemberManagementBean.deleteRecord}"></p:commandLink>
	</div>
	<div class="table-p-bg"></div>
	<p:dataTable id="tb" value="#{MemberManagementBean.data}" var="record"
              selection="#{MemberManagementBean.selectedData}"  rows="22"  paginator="true" 
              paginatorPosition="bottom" styleClass="table-p">
		<p:column selectionMode="multiple" />  
		<p:column style="width:6%">
			<f:facet name="header">
				<span data-i18n="page1.user.title1"></span>
			</f:facet>
			<h:outputText value="#{record.name}" />
		</p:column>  
		<p:column style="width:6%">
			<f:facet name="header">
				<span data-i18n="page1.user.title2"></span>
			</f:facet>
			<h:outputText value="#{record.no}" />
		</p:column>
		<p:column style="width:6%">
			<f:facet name="header">
				<span data-i18n="page1.user.title3"></span>
			</f:facet>
			<h:outputText value="#{record.age}" />
		</p:column>
		<p:column style="width:6%">
			<f:facet name="header">
				<span data-i18n="page1.user.title4"></span>
			</f:facet>
			<h:outputText value="#{record.sex}" />
		</p:column>
		<p:column style="width:6%">
			<f:facet name="header">
				<span data-i18n="page1.user.title5"></span>
			</f:facet>
			<h:outputText value="#{record.birthday}" />
		</p:column>
		<p:column style="width:10%">
			<f:facet name="header">
				<span data-i18n="page1.user.title6"></span>
			</f:facet>
			<h:outputText value="#{record.idcard}" />
		</p:column>
		<p:column style="width:6%">
			<f:facet name="header">
				<span data-i18n="page1.user.title7"></span>
			</f:facet>
			<h:outputText value="#{record.education}" />
		</p:column>
		<p:column style="width:10%">
			<f:facet name="header">
				<span data-i18n="page1.user.title8"></span>
			</f:facet>
			<h:outputText value="#{record.phoneNumber}" />
		</p:column>
		<p:column style="width:6%">
			<f:facet name="header">
				<span data-i18n="page1.user.title9"></span>
			</f:facet>
			<h:outputText value="#{record.address}" />
		</p:column>
		<p:column style="width:14%">
			<f:facet name="header">
				<span data-i18n="page1.user.title10"></span>
			</f:facet>
			<h:outputText value="#{record.email}" />
		</p:column>
		<p:column style="width:6%">
			<f:facet name="header">
				<span data-i18n="page1.user.title11"></span>
			</f:facet>
			<h:outputText value="#{record.positionName}" />
		</p:column>
		<p:column style="width:8%">
			<f:facet name="header">
				<span data-i18n="page1.user.title12"></span>
			</f:facet>
			<h:outputText value="#{record.nodeName}" />
		</p:column>
		<p:column>
			<f:facet name="header">
				<span data-i18n="page1.user.title13"></span>
			</f:facet>
			<h:outputText value="#{record.teamName}" />
		</p:column>
	</p:dataTable>	
	<!-- 插入数据 -->
	<p:dialog id="adddate" widgetVar="adddate" styleClass="div-dialog"> 
		<div id="divInsert">
			<h2 align="center"><span data-i18n="page1.add.main_title"></span></h2>
			<table>
				<tr>
					<td width="15%"><span class="txt-toolbar" data-i18n="page1.user.title1"></span><span style="color:red;font-weight:bold;">*</span></td>
					<td width="35%"><h:inputText id="name" styleClass="input-toolbar"  value="#{MemberManagementBean.insertData.name}"/></td>
					<td width="15%"><span class="txt-toolbar" data-i18n="page1.user.title2"></span><span style="color:red;font-weight:bold;">*</span></td>
					<td width="35%">
						<h:inputText id="no"  styleClass="input-toolbar"  value="#{MemberManagementBean.insertData.no}"/>
						<br />#{MemberManagementBean.msg}
					</td>
				</tr>
				<tr>
					<td><span class="txt-toolbar" data-i18n="page1.user.title8"></span></td>
					<td><h:inputText styleClass="input-toolbar" value="#{MemberManagementBean.insertData.phoneNumber}"/></td>
					<td><span class="txt-toolbar" data-i18n="page1.user.title12"></span></td>
					<td>
						
					</td>			
				</tr>
				<tr>	
					<td><span class="txt-toolbar" data-i18n="page1.user.title11"></span></td>
					<td>
						<h:selectOneMenu id="posit" styleClass="select-toolbar" value="#{MemberManagementBean.positionName}">
							<f:selectItem itemLabel="page1.btn.pls_select" itemValue="0" ></f:selectItem>
							<f:selectItems value="#{MemberManagementBean.positionMap}"></f:selectItems>
						</h:selectOneMenu> 
					</td>
					<td><span class="txt-toolbar" data-i18n="page1.user.title13"></span></td>
					<td>
						<h:selectOneMenu id="team" styleClass="select-toolbar" value="#{MemberManagementBean.teamName}">
							<f:selectItem itemLabel="page1.btn.pls_select" itemValue="0" ></f:selectItem>
							<f:selectItems value="#{MemberManagementBean.teamMap}"></f:selectItems>
						</h:selectOneMenu> 
					</td>
				</tr>
				<tr>	
					<td><span class="txt-toolbar" data-i18n="page1.user.title4"></span></td>
					<td><h:selectOneMenu styleClass="select-toolbar" 
							value="#{MemberManagementBean.insertData.sex}">
							<f:selectItem itemLabel="page1.sex.male" itemValue="男" ></f:selectItem>
							<f:selectItem itemLabel="page1.sex.female" itemValue="女" ></f:selectItem>
						</h:selectOneMenu>
					</td>
					<td><span class="txt-toolbar" data-i18n="page1.user.title6"></span><span style="color:red;font-weight:bold;">*</span></td>
					<td>
						<h:inputText id="idcard" styleClass="input-toolbar"  value="#{MemberManagementBean.insertData.idcard}" />
					</td>
				</tr>
				<tr>
					<td><span class="txt-toolbar" data-i18n="page1.user.title5"></span></td>
					<td><rich:calendar id="startTime0" popup="true" 
											styleClass="input-toolbar" locale="en" 
											inputClass="input-toolbar"
											value="#{MemberManagementBean.insertData.birthday}" datePattern="yyyy-MM-dd"
											cellWidth="10px" cellHeight="20px"  />
					</td>
					<td><span class="txt-toolbar" data-i18n="page1.user.title7"></span></td>
					<td><h:selectOneMenu styleClass="select-toolbar"  
						value="#{MemberManagementBean.insertData.education}">
						<f:selectItem itemLabel="page1.education.item1" itemValue="小学" ></f:selectItem>
						<f:selectItem itemLabel="page1.education.item2" itemValue="初中" ></f:selectItem>
						<f:selectItem itemLabel="page1.education.item3" itemValue="中专" ></f:selectItem>
						<f:selectItem itemLabel="page1.education.item4" itemValue="高中" ></f:selectItem>
						<f:selectItem itemLabel="page1.education.item5" itemValue="大专" ></f:selectItem>
						<f:selectItem itemLabel="page1.education.item6" itemValue="本科" ></f:selectItem>
						<f:selectItem itemLabel="page1.education.item7" itemValue="硕士" ></f:selectItem>
						<f:selectItem itemLabel="page1.education.item8" itemValue="博士" ></f:selectItem>
						<f:selectItem itemLabel="page1.education.item9" itemValue="博士后" ></f:selectItem>
						<f:selectItem itemLabel="page1.education.item10" itemValue="其他" ></f:selectItem>
					</h:selectOneMenu> </td>
				</tr>
				<tr>
					<td><span class="txt-toolbar" data-i18n="page1.user.title10"></span></td>
					<td><h:inputText styleClass="input-toolbar"  value="#{MemberManagementBean.insertData.email}"/></td>
					<td><span class="txt-toolbar" data-i18n="page1.user.title9"></span></td>
					<td><h:inputText styleClass="input-toolbar"  value="#{MemberManagementBean.insertData.address}"/></td>
				</tr>
				<tr>
					<td><span class="txt-toolbar" data-i18n="page1.user.title15"></span></td>
					<td><h:inputText styleClass="input-toolbar"  value="#{MemberManagementBean.insertData.partyAffiliation}"/></td>
					<td><span class="txt-toolbar" data-i18n="page1.user.title16"></span></td>
					<td><h:inputText styleClass="input-toolbar" value="#{MemberManagementBean.insertData.salary}"/></td>	
				</tr>
				<tr>
					<td><span class="txt-toolbar" data-i18n="page1.user.title14"></span></td>
					<td><h:inputText styleClass="input-toolbar" value="#{MemberManagementBean.insertData.memo}"/></td>
					<td><span class="txt-toolbar" data-i18n="page1.user.title17"></span></td>
					<td>
						<h:selectOneMenu  style="color:#595959;" value="#{MemberManagementBean.selectUserId}" styleClass="select-toolbar">
							<f:selectItem itemLabel="page1.btn.pls_select" itemValue=""></f:selectItem>
							<f:selectItems value="#{MemberManagementBean.scrapUserList}" var="user" itemLabel="#{user.name}" 
								itemValue="#{user.userId}"></f:selectItems>
						</h:selectOneMenu>
					</td>		
				</tr>
	
			</table>
			
			<div class="dialog-bottomBar">
				<h:inputHidden id="hvalue" value="#{MemberManagementBean.msg}"/>
				<p:commandButton id="inbtn" styleClass="btn-toolbar" value="page1.btn.save" action="#{MemberManagementBean.insertRecord}"  
				update=":myform" onclick="return checkEmpty('name','no','idcard');"></p:commandButton>
				<p:commandButton styleClass="btn-toolbar" value="page1.btn.cancel" oncomplete="adddate.hide()"></p:commandButton>			
			</div>
		</div>
	</p:dialog>
	<!-- 数据更新 -->
	<p:dialog id="update" widgetVar="update" styleClass="div-dialog">
	<div id="divUpdate">	          
	    <h2 align="center"><span data-i18n="page1.edit.main_title"></span></h2>
		<table>
			<tr>
				<td width="15%"><span class="txt-toolbar" data-i18n="page1.user.title1"></span><span style="color:red;font-weight:bold;">*</span></td>
				<td width="35%"><h:inputText id="name2" styleClass="input-toolbar"  value="#{MemberManagementBean.newData.name}" /></td>
				<td width="15%"><span class="txt-toolbar" data-i18n="page1.user.title2"></span><span style="color:red;font-weight:bold;">*</span></td>
				<td width="35%"><h:inputText id="no2" styleClass="input-toolbar"  value="#{MemberManagementBean.newData.no}"/></td>
			</tr>
			<tr>
				<td><span class="txt-toolbar" data-i18n="page1.user.title8"></span></td>
				<td><h:inputText styleClass="input-toolbar" value="#{MemberManagementBean.newData.phoneNumber}"/></td>				
				<td><span class="txt-toolbar" data-i18n="page1.user.title14"></span></td>
				<td><h:inputText styleClass="input-toolbar" value="#{MemberManagementBean.newData.memo}"/></td>
			</tr>
			<tr>
				<td><span class="txt-toolbar" data-i18n="page1.user.title4"></span></td>
				<td><h:selectOneMenu styleClass="select-toolbar"
						value="#{MemberManagementBean.newData.sex}">
						<f:selectItem itemLabel="page1.sex.male" itemValue="男" ></f:selectItem>
						<f:selectItem itemLabel="page1.sex.female" itemValue="女" ></f:selectItem>
					</h:selectOneMenu>
				</td>
				<td><span class="txt-toolbar" data-i18n="page1.user.title6"></span><span style="color:red;font-weight:bold;">*</span></td>
				<td>
					<h:inputText id="idcard2" styleClass="input-toolbar"  value="#{MemberManagementBean.newData.idcard}" />
				</td>					
			</tr>
			<tr>		
				<td><span class="txt-toolbar" data-i18n="page1.user.title5"></span></td>
				<td><rich:calendar id="startTime" popup="true"
									styleClass="input-toolbar" locale="en" 
									inputClass="input-toolbar"
									value="#{MemberManagementBean.newData.birthday}" datePattern="yyyy-MM-dd"
									cellWidth="10px" cellHeight="20px"  />
				</td>
				<td><span class="txt-toolbar" data-i18n="page1.user.title7"></span></td>
				<td><h:selectOneMenu styleClass="select-toolbar"
					value="#{MemberManagementBean.newData.education}">
					<f:selectItem itemLabel="page1.education.item1" itemValue="小学" ></f:selectItem>
					<f:selectItem itemLabel="page1.education.item2" itemValue="初中" ></f:selectItem>
					<f:selectItem itemLabel="page1.education.item3" itemValue="中专" ></f:selectItem>
					<f:selectItem itemLabel="page1.education.item4" itemValue="高中" ></f:selectItem>
					<f:selectItem itemLabel="page1.education.item5" itemValue="大专" ></f:selectItem>
					<f:selectItem itemLabel="page1.education.item6" itemValue="本科" ></f:selectItem>
					<f:selectItem itemLabel="page1.education.item7" itemValue="硕士" ></f:selectItem>
					<f:selectItem itemLabel="page1.education.item8" itemValue="博士" ></f:selectItem>
					<f:selectItem itemLabel="page1.education.item9" itemValue="博士后" ></f:selectItem>
					<f:selectItem itemLabel="page1.education.item10" itemValue="其他" ></f:selectItem>
				</h:selectOneMenu> </td>
			</tr>
			<tr>
				<td><span class="txt-toolbar" data-i18n="page1.user.title10"></span></td>
				<td><h:inputText styleClass="input-toolbar" value="#{MemberManagementBean.newData.email}"/></td>
				<td><span class="txt-toolbar" data-i18n="page1.user.title9"></span></td>
				<td><h:inputText styleClass="input-toolbar" value="#{MemberManagementBean.newData.address}"/></td>
			</tr>
			<tr>
				<td><span class="txt-toolbar" data-i18n="page1.user.title15"></span></td>
				<td><h:inputText styleClass="input-toolbar" value="#{MemberManagementBean.newData.partyAffiliation}"/></td>
				<td><span class="txt-toolbar" data-i18n="page1.user.title16"></span></td>
				<td><h:inputText styleClass="input-toolbar" value="#{MemberManagementBean.newData.salary}"/></td>
			</tr>
			<tr>
				<td><span class="txt-toolbar" data-i18n="page1.user.title14"></span></td>
				<td><h:inputText styleClass="input-toolbar" value="#{MemberManagementBean.newData.memo}"/></td>
				<td><span class="txt-toolbar" data-i18n="page1.user.title17"></span></td>
				<td>
					<h:selectOneMenu style="color:#595959;" value="#{MemberManagementBean.updateUserId}" styleClass="select-toolbar">
						<f:selectItem itemLabel="page1.btn.pls_select" itemValue=""></f:selectItem>
						<f:selectItems value="#{MemberManagementBean.scrapUserList}" var="user" itemLabel="#{user.name}" 
							itemValue="#{user.userId}"></f:selectItems>
					</h:selectOneMenu>
				</td>		
			</tr>
		</table>
		<div class="dialog-bottomBar">
			<p:commandButton styleClass="btn-toolbar" value="page1.btn.save"  action="#{MemberManagementBean.updateRecord}"  update="myform:tb" onclick="return checkEmpty('name2','no2','idcard2');" oncomplete="$('#divUpdate').hide();transElementId('myform:tb');"></p:commandButton>
			<p:commandButton styleClass="btn-toolbar" value="page1.btn.cancel"  oncomplete="update.hide()"></p:commandButton>
		</div>
	</div>
	</p:dialog>
	<script type="text/javascript">
	//<![CDATA[
		$(document).ready(function(){
			//国际化
		    $(".iconBtn-toolbar,.btn-toolbar>span,option").attr("data-i18n", function() {return $(this).text();});
		    dataTranslate("member_setting", function(t) {
		    	$(document).i18n();
		    }, "../static/i18nAdmin");
		    
		});	
		
		/* 局部翻译 */
		function transElementId(selector) {
		    $(".ui-button-text,option").each(function() {
		    	$(this).attr("data-i18n", $(this).text());
		    });
			var obj = document.getElementById(selector);
			$(obj).i18n();
		}
		
		function checkEmpty(v1,v2,v3){
			var a=document.getElementById("myform:"+v1).value;
			var b=document.getElementById("myform:"+v2).value;
			var c=document.getElementById("myform:"+v3).value;
			var d=document.getElementById("myform:selectUserId").value;
			if(a==""||b==""||c==""||d==""){
				alert("姓名、工号、身份证、关联账号为必填字段，提交失败！");return false;
			}
			else{
				return true;
			}
		}
		

		function check(){
			
			
			$('#divInsert').hide();
			var c=document.getElementById("myform:hvalue").value;
			if(c=="1")
				alert("工号重复，新建失败！");
		}
				
		function del(){
			if(confirm("确定删除？")){
				return true;
			}else{
				return false;
			}
		}
		
		function showInsert(){
			$("#divInsert").show();
		}
		
		function showUpdate(){
			$("#divUpdate").show();
		}
		
		function searchFocus(id){
			var valueStr = document.getElementById('txt_placeholder').value;
			if(document.getElementById(id).value==valueStr)
				document.getElementById(id).value=""
		}
		
		function searchBlur(id){
			var valueStr = document.getElementById('txt_placeholder').value;
			if(document.getElementById(id).value=="")
				document.getElementById(id).value=valueStr
		}
		
		function checkIdcard(){
			var v=document.getElementById("myform:idcard").value;
			if(v==""||v==null)
				alert("请输入身份证号！");

		}

	//]]>	
	</script>
	<h:outputScript library="js" name="tree.js"></h:outputScript>
</ui:composition>
