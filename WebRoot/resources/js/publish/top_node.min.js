function getNodeInfo(a){function b(a){a=JSON.parse(a),a=a.data;var b=document.createElement("div");b.className="zl-top-menu-sub-frame";var c=document.createElement("div");c.className="zl-top-menu-sub-content";for(var d=0;d<a.length;d++){var e=a[d].nodeId,f=a[d].name,g=a[d].childNodesNum;c.appendChild(createNodeMenu(e,f,g))}b.appendChild(c),$("#top_node").empty().append(b),$("#top_node").find(".zl-top-menu>span").click(function(){parseInt($(this).attr("sub_num"))>0?($("#parent_node").show().empty().append(createNodeMenu($(this).attr("node_id"),$(this).text(),"0")),$("#top_node").addClass("sub"),$("#parent_node .zl-top-menu:eq(0)>span").click(function(){nodeClick($(this).attr("node_id"))}),$.autosizeElement($("#parent_node")[0],!0),getNodeInfo($(this).attr("node_id")),$("#top_node .zl-top-menu-sub-content").width(function(){var a=0;return $(this).find(".zl-top-menu").each(function(){a+=$(this).width()+1}),a}),$("#top_node .zl-top-menu-sub-frame").width($(".zl-top-menu-center").width()-$("#top_node .zl-top-menu-sub-frame").position().left),parentId=$(this).attr("node_id")):"沈阳"==$(this).text()?location.href="http://10.10.140.58:8080/mocs/index.faces":nodeClick($(this).attr("node_id"))}),$(".zl-top-menu>span").each(function(){$(this).text().length>8&&$(this).parent().css("width","auto")}),$(c).width(function(){var a=0;return $(this).find(".zl-top-menu").each(function(){a+=$(this).width()+1}),a}),$(b).width($(".zl-top-menu-center").width()-$(b).position().left-1),$.autosizeElement($("#top_node>div")[0],!0),moveCurrentNode()}var c=window.sessionStorage;return c.getItem("node_id")==a?void b(c.getItem("node_value")):void $.ajax({url:url,async:!1,data:"nodeId="+a+"&userId="+userId,cache:!1,dataType:"text",success:function(d){b(d),c.setItem("node_id",a),c.setItem("node_value",d)}})}function createNodeMenu(a,b,c){var d=document.createElement("div");d.className="zl-top-menu",nodeId==a&&$(d).addClass("cur");var e=document.createElement("span");e.setAttribute("node_id",a),e.setAttribute("sub_num",c),$(e).text(b);var f=document.createElement("div");return f.className="zl-top-split",d.appendChild(e),d.appendChild(f),d}function nodeClick(a){document.getElementById("pointform:nodeid").value=a,document.getElementById("pointform:update").click()}function moveCurrentNode(){var a=0;if($("#top_node .zl-top-menu.cur").length>0&&$(".zl-top-menu-sub-content").width()>$(".zl-top-menu-sub-frame").width()){a=$(".zl-top-menu-sub-frame").offset().left-$("#top_node .zl-top-menu.cur").offset().left;var b=$(".zl-top-menu-sub-frame").offset().left+$(".zl-top-menu-sub-content").width()-$("#top_node .zl-top-menu.cur").offset().left;b<$(".zl-top-menu-sub-frame").width()&&(a+=$(".zl-top-menu-sub-frame").width()-b),$(".zl-top-menu-sub-content").css("margin-left",a)}0==a&&$(".zl-top-menu-left").addClass("disable"),a+$(".zl-top-menu-sub-content").width()<=$(".zl-top-menu-sub-frame").width()&&$(".zl-top-menu-right").addClass("disable")}var userId=document.getElementById("pointform:userid").value,parentId=document.getElementById("pointform:parentid").value,nodeId=document.getElementById("pointform:nodeid").value,parentNode="-999",url="WSUserService/getAllNodesByParentNodeId.json";$(document).ready(function(){""==parentId&&(parentId=parentNode),menuLoadFlag&&getNodeInfo(parentId),$(".zl-icon-home").mousedown(function(){$(this).addClass("active")}).mouseup(function(){$(".zl-top-menu-left,.zl-top-menu-right").removeClass("disable"),$(this).removeClass("active"),$("#parent_node").hide(),getNodeInfo(parentNode)}),$(".zl-top-menu-left,.zl-top-menu-right").click(function(){var a=parseFloat($(".zl-top-menu-sub-content").css("margin-left").replace("px","")),b=$(".zl-top-menu-sub-frame").width()-$(".zl-top-menu-sub-content").width(),c=$(".zl-top-menu-sub-frame").width()/2,d=$("#top_node .zl-top-menu").length,e=4;""!=parentId&&"-999"!=parentId&&(e=3),$(this).hasClass("zl-top-menu-left")?a+=c:a-=c,$(".zl-top-menu-left,.zl-top-menu-right").removeClass("disable"),e>=d?(a=0,$(".zl-top-menu-left,.zl-top-menu-right").addClass("disable")):(a>=0&&(a=0,$(".zl-top-menu-left").addClass("disable")),b>=a&&(a=b,$(".zl-top-menu-right").addClass("disable"))),$(".zl-top-menu-sub-content").animate({marginLeft:a},200)})});