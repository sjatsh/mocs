<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<!-- Mimic Internet Explorer 8 -->
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8"  />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<title>车间管理</title>
	<script type="text/javascript">
	
	var wjb51 = 0;
	var hjb51 = 0;
	hjb51 = document.documentElement.clientHeight;
	wjb51 = document.documentElement.clientWidth;
	if(hjb51>wjb51){ //高大于宽 ，高等比缩小 
			hjb51 = wjb51*1080/1920; 
		//	   hjb51 = 600; 
		//	   wjb51 = 800;
		}
	if(600>hjb51){  //高小于600，赋值为600，设滚动条为滚动 
		   hjb51 = 600; 
		   wjb51 = 800;
		   document.body.style.overflow="scroll";
	   }
	if(800>wjb51){
		   hjb51 = 600;
		   wjb51 = 800;
		   document.body.style.overflow="scroll";
	}	
	var fadeouttime = 500;
	var settimeout = 100;
	
	function imgdragstart(){return false;}
	</script>	
	<link rel="stylesheet" href="css/menucss/zzsc.css" type="text/css"></link>
	<link rel="stylesheet" href="css/menucss/maps.css" type="text/css"></link>
	<link rel="stylesheet" href="css/menucss/test.css" type="text/css"></link>
	<link rel="stylesheet" href="css/basicTemplate.css" type="text/css"></link>
	<link rel="stylesheet" href="css/autosize.css" type="text/css"></link>
	
	<h:outputScript library="js" name="highcharts.js"></h:outputScript>
	<h:outputScript library="js" name="exporting.js"></h:outputScript>
	<h:outputScript library="js" name="highcharts-more.js"></h:outputScript>
	<h:outputScript library="js" name="common.js"></h:outputScript>
	<h:outputScript library="js" name="workshop_management.js"></h:outputScript>
	<h:outputScript library="js" name="autosize.js"></h:outputScript>


<!-- 	<h:outputScript library="menujs" name="maps.js"></h:outputScript> -->
	<h:outputScript library="menujs" name="google.js"></h:outputScript>
	<h:outputScript library="menujs" name="jquery-ui-1.10.4.js"></h:outputScript>
	<h:outputScript library="menujs" name="index.js"></h:outputScript>
	<h:outputScript library="js" name="common.js"></h:outputScript>
</h:head>
<h:body>
	<div class="frame-wrapper auto-size" id="mocscontains">
		<div class="frame-content  auto-size" id="mocscontainstop">
			<div class="tsddivclass" id="tsdiv001" >
				<img src="images/gdtsbg.png" class="tsddivimg"/>
				<table style="width: 100%;height: 100%;">
					<tr>
						<td style="width: 20%"></td>
						<td style="width: 80%;line-height: 100%;height: 100%;vertical-align: middle;" id="tsdivtd001" ></td>
					</tr>
				</table>
			</div>
			<div class="tscontentclass" id="tscontent" style="display: none;border: 0px solid red;">
				<table style="width: 100%;border: 0px solid red;height: 100%;" border="0">
					<tr style="height:18%">
						<td style="width: 64%;font-size:85%;" id="tscount" ></td>
						<td style="width: 36%;">
							<img src="images/tszxh.png" alt="最小化" onclick="zuixiaohua()" style="width:31%;height:70%;" />
							<img src="images/tsgb.png" alt="关闭"  onclick="guanbi()" 
							style="margin-left:10%;width:30%;height:70%;" />
						</td>
					</tr>
					<tr style="height:82%">
						<td colspan="2" id="tsgdnr" style="font-size: 80%;width: 100%;" valign="top" align="center"></td>
					</tr>
				</table>
			</div>
			<ui:insert name="content" ></ui:insert>
		</div>
		<div class="frame-nav auto-size" id="mocscontainsbottom">
			<ui:include src="/templates/includes/menu.xhtml" />
		</div>
	</div>
		<div style="display: none;">
	
		<h:form id="myts1">
		<h:inputHidden id="hidden" value="#{tsControlBean.prams}"></h:inputHidden>
		<p:commandButton actionListener="#{menuBean.getSelectItem('b21.scdd')}" id="tssubmit"
		value=" " style="display:none;"></p:commandButton>
		<a4j:poll action="#{tsControlBean.refreshData}" interval="500000000" render="reloadTs" oncomplete="reloadTs()" ></a4j:poll>
		<a4j:outputPanel id="reloadTs">
			<h:inputHidden id="gdTs" value="#{tsControlBean.ts}" />
		</a4j:outputPanel> 
		</h:form>
	
		</div>
		
		<script type="text/javascript">
		//<![CDATA[	
		           
		function reloadTs(){
			var gdTs = document.getElementById("myts1:gdTs").value; 
			var count=gdTs.split(",");
			if(count.length>0){
				document.getElementById("tsdivtd001").innerHTML="您有"+count.length+"个工单待关闭!";
				var tt=document.getElementById("tscontent").style.display+"";
				
				if(tt=="none"){
					document.getElementById("tsdiv001").style.display="block";
				}
				document.getElementById("tsdiv001").onclick=function(){
					document.getElementById("tsdiv001").style.display="none";
					document.getElementById("tscontent").style.display="block";
					var gdTs1 = document.getElementById("myts1:gdTs").value; 
					var ss=gdTs1.split(",");
					document.getElementById("tscount").innerHTML="<span>&#160;&#160;以下"+ss.length+"个工单待关闭</span>";
					document.getElementById("tsgdnr").innerHTML="";
					var co=3;
					if(ss.length<=3){
						co=ss.length;
					}
					for(var i=0;i<co;i++){
						var aa=ss[i];
						var bb=aa.split("|");
						var cc=bb[1];
						var ee=bb[0];
						var ff;
						//alert("ee:"+ee);
						if(i==0){
							ff=ee.substring(4,ee.length);
						}else if(i==ss.length){
							ff=ee.substring(0,ee.length-1);
						}else{
							ff==ee.substring(4,ee.length);
						}
						//alert("ff:"+ff);
						var value=cc.substring(5,cc.length);
						value=value.substring(value.length-14,value.length);
						document.getElementById("tsgdnr").innerHTML+="<div style='height:25%;widht:100%;font-size:120%;cursor:pointer' "
						+" onclick='localAddress(\""+ff+"\")'>"
						+"<img src='images/tsgdtb.png'style='width:18%;height:98%;'>"+value
						+"</div><hr style='width:100%;height:2px;'/>";
					}
					
					if(ss.length>3){
						document.getElementById("tsgdnr").innerHTML+="<div style='widht:100%;height:25%;font-size:150%'>查看所有</div>";
					}
					
				} 
			}
		}
		function localAddress(address){
			 SetCookie("jobdispathcNo",address);
			 window.location.href='index.faces?page=/mocs/jobdispatch/jobdispatch.xhtml';
			 document.getElementById("myts1:tssubmit").click();
			 
		}
		function zuixiaohua(){
			document.getElementById("tsdiv001").style.display="block";
			document.getElementById("tscontent").style.display="none";
		}
		function guanbi(){
			document.getElementById("tsdiv001").style.display="none";
			document.getElementById("tscontent").style.display="none";
		}
		//]]>	
		</script>
	<script type="text/javascript">
	
	

function findDimensions() // 函数：获取尺寸
{

/* document.getElementById("mocscontains").style.width=wjb51+"px";
document.getElementById("mocscontains").style.height=hjb51+"px";

document.getElementById("mocscontainstop").style.height=hjb51*90/100-20+"px"; //不知道为什么资料和子页面中间都减20 
document.getElementById("mocscontainsbottom").style.height=hjb51*8/100+"px"; */

}

function findDimensions1() // 函数：获取尺寸 
{

/* document.getElementById("mocscontains").style.width=wjb51+"px";
document.getElementById("mocscontains").style.height=hjb51+"px";

document.getElementById("mocscontainstop").style.height=hjb51*90/100-20+"px"; 
document.getElementById("mocscontainsbottom").style.height=hjb51*90/1080+"px";

window.location.href=window.location.href; //重新载入页面   */

}
 
//findDimensions();  //一进入就执行一次 
// 调用函数，获取数值
//window.onresize=findDimensions1;  //窗口改变时执行 

//页面大小调整
$.autosizeInit(1920,1080,800,600);
$.autosizeMore();


if(navigator.userAgent &amp;&amp; navigator.userAgent.split(";")[1].toLowerCase().indexOf("msie")>-1){
    document.body.innerHTML = '<div onresize="findDimensions1();" style="width:100%;height:100%;position:absolute;z-index:-999;"></div>' + document.body.innerHTML;    
} else {
	window.onresize = findDimensions1;
}

for(i in document.images)document.images[i].ondragstart=imgdragstart;
</script>	
			
</h:body>
</html>
