<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">
	<style type="text/css">
		td{
			word-break: break-all;
		}
	</style>
	
	<link rel="stylesheet" href="../css/b21.css" type="text/css"></link>
	<link rel="stylesheet" href="../css/b22.css" type="text/css"></link>
<div style="width: 100%;height: 100%; position:relative;">
	<div class="headDiv">
		<h:inputText id="txt" value="#{tFixtureConfigBean.query}" styleClass="textBg" onfocus="searchFocus('myform:txt');" onblur="searchBlur('myform:txt');"/> 
		<p:commandButton value="查询" update=":myform:singletree :myform:carList" actionListener="#{tFixtureConfigBean.queryData}" oncomplete="bgReposition($('.table'));" styleClass="delete"></p:commandButton>
		<div class="button-split"></div> 
		<p:commandButton value="新增" oncomplete="addFx.show();bgReposition($('.table'));" styleClass="delete"></p:commandButton>
        <p:commandButton value="删除" actionListener="#{tFixtureConfigBean.deleteDataTable}" update=":myform:carList" oncomplete="bgReposition($('.table'));" styleClass="delete"></p:commandButton>
	</div>
	<div class="div-content-top-shadow">
		<img src="../images/demo/right_top_shadow.png" />
	</div>
	<div class="materail_class_treeDiv">
		<div class="tree-head"></div>
		<div class="tree-body">
			<p:tree value="#{tFixtureConfigBean.root}" var="node" id="singletree" selectionMode="single"  
			   selection="#{tFixtureConfigBean.selectedPart}" style="width:140px;">  
			      <p:ajax event="select" update=":myform:carList :myform:type" 
			      listener="#{tFixtureConfigBean.getPartProcessList}" oncomplete="bgReposition($('.table'));" /> 
			   <p:treeNode id="treeNode">  
			       <h:outputText value="#{node.name}" id="lblNode"/>  
			   </p:treeNode>  
			</p:tree>
        </div>
		<div class="tree-foot"></div>
		<div class="div_tree_border_shadow">
			<img src="../images/demo/tree_border_shadow.png" />
		</div>
		<div id="tree_move_btn" class="btn_tree_show"></div>
    </div>
     <div class="materail_class_rightDiv hidden" id="planDiv">
      <p:dataTable var="material" value="#{tFixtureConfigBean.mediumMaterialModel}" id="carList" editable="true" 
    	   sortMode="multiple" dynamic="true" selection="#{tFixtureConfigBean.selectedMaterial}" paginator="true" rows="10" paginatorPosition="bottom" styleClass="table">
       <p:ajax event="rowEdit" listener="#{tFixtureConfigBean.onEdit}" update=":myform:carList" />
    	<p:column headerText="" style="width:2%" />
	   <p:column selectionMode="multiple" style="width:5%"  />
       <p:column headerText="夹具类型名称" style="width:20%"  >
            <p:cellEditor>
                <f:facet name="output">
                    <h:outputText value="#{material.ufixName}" />
                </f:facet>
                <f:facet name="input">
                    <p:inputText value="#{material.ufixName}"  readonly="true"/>
                </f:facet>
            </p:cellEditor>
        </p:column>
        
  		<p:column headerText="夹具类型编号" style="width:20%"  >
            <p:cellEditor>
                <f:facet name="output">
                    <h:outputText value="#{material.ufixNo}" />
                </f:facet>
                <f:facet name="input">
                    <p:inputText value="#{material.ufixNo}"   />
                </f:facet>
            </p:cellEditor>
        </p:column>
		 <p:column headerText="夹具类别" style="width:18%" >
            <p:cellEditor>
                <f:facet name="output">
                    <h:outputText value="#{material.type}" />
                </f:facet>
                <f:facet name="input">
                     <h:outputText value="#{material.type}" /> 
                </f:facet>
            </p:cellEditor>
        </p:column>
         <p:column headerText="描述" style="width:20%">
            <p:cellEditor>
                <f:facet name="output">
                    <h:outputText value="#{material.ufixMemo}" />
                </f:facet>
                <f:facet name="input">
               	 	<p:inputText value="#{material.ufixMemo}"  />
                </f:facet>
            </p:cellEditor>
        </p:column>
         <p:column headerText="图纸" style="width:10%" >
            <p:cellEditor>
                <f:facet name="output">
                    <h:link>上传</h:link>
                	<h:outputText value=" | "></h:outputText>
                    <h:link>下载</h:link>
                </f:facet>
                <f:facet name="input">
               	 	<h:link>上传</h:link>
                	<h:outputText value=" | "></h:outputText>
               	 	<h:link>下载</h:link>
                </f:facet>
            </p:cellEditor>
        </p:column>
        <p:column headerText="操作" style="width:5%">
            <p:rowEditor />
        </p:column>
    </p:dataTable>
     </div>
     <p:dialog widgetVar="addFx" resizable="false">
     	<p:panel id="addData">
     		<table>
     			<tr>
     				<td>夹具类型名称：<font style="color:red;">*</font></td>
     				<td><h:inputText value="#{tFixtureConfigBean.addTfm.ufixName}" id="ufixName" style="border: 1px black solid;"></h:inputText></td>
     				<td><div style="color: gray;">例：车床夹具1组</div></td>
     			</tr>
     			<tr>
     				<td>夹具类型编号：<font style="color:red;">*</font></td>
     				<td><h:inputText value="#{tFixtureConfigBean.addTfm.ufixNo}" id="fixNo" style="border: 1px black solid;"></h:inputText></td>
     				<td><div style="color: gray;">例：F-Turning-01</div></td>
     			</tr>
     			<tr>
     				<td>夹具类别：<font style="color:red;">*</font></td>
     				<td><h:inputText value="#{tFixtureConfigBean.addTfm.type}" id="type" style="border: 1px black solid;" readonly="true"></h:inputText></td>
     				<td><div style="color: gray;">例：车床夹具</div></td>
     			</tr>
     			<tr>
     				<td>描述：</td>
     				<td colspan="2">
     					<h:inputTextarea value="#{tFixtureConfigBean.addTfm.ufixMemo}"></h:inputTextarea>
     				</td>
     				
     			</tr>
     		</table>
     		<div class="headDivduan">
				<p:commandButton value="新增" onclick="subBtn()" styleClass="delete"></p:commandButton> 
				<p:commandButton value="新增" actionListener="#{tFixtureConfigBean.addTfmData}" 
					update=":myform:carList :myform:messages :myform:addData"  oncomplete="addFx.hide()" style="display:none;" id="addJJbtn">
				</p:commandButton>
     		</div>
		</p:panel>
     </p:dialog>
 </div>
     
	
	<p:growl id="messages" showDetail="true"/>  
    <script type="text/javascript">
	//<![CDATA[
	       function xianshi(){
		   	document.getElementById("addData").style.display="block";
	   		}
	       function guanbi(){
	    	   document.getElementById("addData").style.display="none";
	       }
	       function subBtn(){
	    	   var ufixName =document.getElementById("myform:ufixName").value;
	    	   var fixNo =document.getElementById("myform:fixNo").value;
	    	   var type =document.getElementById("myform:type").value;
	    	   if(null==type||""==type){
	    		   alert("请选择一个夹具类型！");
	    	   }else if(null==ufixName||""==ufixName){
	    		   alert("请输入名字！");
	    	   }else if(null==fixNo||""==fixNo){
	    		   alert("请输入编号！");
	    	   }else{
	    		   document.getElementById("myform:addJJbtn").click();   
	    	   }
	    	   
	       }
	       function searchFocus(id){
				if(document.getElementById(id).value=="输入夹具名称")
					document.getElementById(id).value=""
			}
			
			function searchBlur(id){
				if(document.getElementById(id).value=="")
					document.getElementById(id).value="输入夹具名称"
			}
			document.getElementById("myform:txt").value="输入夹具名称";
			
	//]]>
	</script>
	<h:outputScript library="js" name="table_tree.js"></h:outputScript> 

</ui:composition>
